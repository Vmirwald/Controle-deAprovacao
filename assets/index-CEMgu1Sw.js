import{r as L,o as O,a as l,c as d,b as o,d as b,w as D,u as T,e as u,f as U,R as M,g as P,t as p,h as V,F as A,i as w,n as I,j as K,k as x,v as N,l as C,m as z,p as k,q as H,s as j,x as W,y as Y}from"./vue-vendor-CaE-17CA.js";import{g as S,o as B,s as J,i as Q,a as X,b as f,c as g,q as $,w as F,d as Z}from"./vendor-BoDgcQ-v.js";import{C as E,r as ee}from"./chartjs-v-CiLEzH.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const n of t)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function a(t){const n={};return t.integrity&&(n.integrity=t.integrity),t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?n.credentials="include":t.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(t){if(t.ep)return;t.ep=!0;const n=a(t);fetch(t.href,n)}})();const _=(s,e)=>{const a=s.__vccOpts||s;for(const[r,t]of e)a[r]=t;return a},te={id:"app"},se={class:"app-header"},oe={class:"app-nav"},ae={class:"app-main"},re={__name:"App",setup(s){const e=S(),a=L(!1);O(()=>{B(e,t=>{a.value=!!t})});function r(){J(e).then(()=>{alert("Você saiu com sucesso!"),window.location.href="/login"}).catch(t=>{console.error("Erro ao sair:",t.message)})}return(t,n)=>(l(),d("div",te,[o("header",se,[o("nav",oe,[b(T(M),{to:"/",class:"nav-link"},{default:D(()=>n[0]||(n[0]=[U("Dashboard")])),_:1}),a.value?(l(),d("button",{key:0,class:"logout-button",onClick:r}," Sair ")):u("",!0)])]),o("main",ae,[b(T(P))])]))}},ne=_(re,[["__scopeId","data-v-4aff2a07"]]),ie={name:"GenericCard",props:{title:{type:String,required:!0},showNewButton:{type:Boolean,default:!0}}},le={class:"card generic-card"},de={class:"card-header d-flex justify-content-between align-items-center"},ce={class:"mb-0"},pe={class:"card-body"},ue={key:0,class:"card-footer"};function me(s,e,a,r,t,n){return l(),d("div",le,[o("div",de,[o("h5",ce,p(a.title),1),a.showNewButton?(l(),d("button",{key:0,class:"btn btn-sm btn-primary",onClick:e[0]||(e[0]=i=>s.$emit("newItem"))},e[1]||(e[1]=[o("i",{class:"fas fa-plus"},null,-1),U(" Novo ")]))):u("",!0)]),o("div",pe,[V(s.$slots,"content",{},()=>[e[2]||(e[2]=o("p",{class:"text-muted"},"Sem conteúdo disponível.",-1))])]),s.$slots.footer?(l(),d("div",ue,[V(s.$slots,"footer",{},void 0)])):u("",!0)])}const he=_(ie,[["render",me],["__scopeId","data-v-f107b3e7"]]);E.register(...ee);const fe={props:{title:{type:String,default:""},labels:{type:Array,required:!0,validator(s){return s.every(e=>typeof e=="string")}},data:{type:Array,required:!0,validator(s){return s.every(e=>typeof e=="number"&&e>=0)}},colors:{type:Array,required:!0,validator(s){return s.every(e=>typeof e=="string")}},width:{type:String,default:"100%"},height:{type:String,default:"400px"}},data(){return{selectedIndex:null}},mounted(){this.createChart()},methods:{createChart(){const s=this.$refs.chartCanvas.getContext("2d");this.chart=new E(s,{type:"doughnut",data:{labels:this.labels,datasets:[{data:this.data,backgroundColor:this.colors,hoverOffset:15}]},options:{responsive:!0,plugins:{tooltip:{enabled:!0}},onHover:(e,a)=>{if(a.length){const r=a[0],t=this.chart.data.datasets[r.datasetIndex];t.hoverOffset=20,this.chart.update()}},onLeave:()=>{this.chart.data.datasets.forEach((e,a)=>{e.hoverOffset=this.selectedIndex===a?20:15}),this.chart.update()},onClick:(e,a)=>{if(a.length){const t=a[0].index;this.selectedIndex=t,this.chart.data.datasets.forEach((i,c)=>{i.hoverOffset=c===this.selectedIndex?20:15}),this.chart.update();const n=this.labels[t];this.$emit("section-clicked",n)}}}})}},beforeUnmount(){this.chart&&this.chart.destroy()}},ge={ref:"chartCanvas"};function ve(s,e,a,r,t,n){return l(),d("div",null,[o("canvas",ge,null,512)])}const be=_(fe,[["render",ve],["__scopeId","data-v-da577b21"]]),_e={props:{headers:{type:Array,default:()=>[]},rows:{type:Array,default:()=>[]},descriptionKey:{type:String,default:"comments"}},data(){return{tooltipVisible:!1,tooltipContent:"",filters:{},filteredRows:[]}},watch:{rows:{handler(s){this.filteredRows=[...s]},immediate:!0}},methods:{getColumnAlignment(s){const e=this.headers.find(a=>a.value===s);return(e==null?void 0:e.align)||"text-center"},applyFilters(){this.filteredRows=this.rows.filter(s=>Object.keys(this.filters).every(e=>{var t,n;const a=((t=this.filters[e])==null?void 0:t.toLowerCase())||"";return(((n=s[e])==null?void 0:n.toString().toLowerCase())||"").includes(a)}))}}},ye={class:"table-responsive"},De={class:"table table-striped table-hover"},Ae={key:0,class:"mt-2"},we=["onUpdate:modelValue"],Ce=["onClick"],xe={key:0},Se=["title"],Ne={key:1},ke={key:0},Ue=["colspan"],Te={class:"tooltip-content"};function Ve(s,e,a,r,t,n){var i;return l(),d("div",ye,[o("table",De,[o("thead",null,[o("tr",null,[(l(!0),d(A,null,w(a.headers,c=>(l(),d("th",{key:c.value,class:I(c.align||"text-center"),style:K({verticalAlign:c.verticalAlign||"middle"})},[U(p(c.text)+" ",1),c.filterable?(l(),d("div",Ae,[x(o("input",{type:"text",class:"form-control form-control-sm","onUpdate:modelValue":m=>t.filters[c.value]=m,onInput:e[0]||(e[0]=(...m)=>n.applyFilters&&n.applyFilters(...m)),placeholder:"Filtrar"},null,40,we),[[N,t.filters[c.value]]])])):u("",!0)],6))),128))])]),o("tbody",null,[(l(!0),d(A,null,w(t.filteredRows,(c,m)=>(l(),d("tr",{key:m,onClick:h=>s.$emit("rowClick",c)},[(l(!0),d(A,null,w(c,(h,y)=>(l(),d("td",{key:y,class:I(n.getColumnAlignment(y))},[y===a.descriptionKey&&h?(l(),d("span",xe,[o("span",{class:"info-icon",title:h},e[3]||(e[3]=[o("i",{class:"fas fa-info-circle"},null,-1)]),8,Se)])):(l(),d("span",Ne,p(h),1))],2))),128))],8,Ce))),128)),t.filteredRows.length===0?(l(),d("tr",ke,[o("td",{colspan:((i=a.headers)==null?void 0:i.length)||1,class:"text-center"},"Nenhum dado disponível",8,Ue)])):u("",!0)])]),t.tooltipVisible?(l(),d("div",{key:0,class:"tooltip-container",onClick:e[2]||(e[2]=c=>t.tooltipVisible=!1)},[o("div",Te,[o("p",null,p(t.tooltipContent),1),o("button",{class:"btn btn-primary",onClick:e[1]||(e[1]=c=>t.tooltipVisible=!1)},"Fechar")])])):u("",!0)])}const Ie=_(_e,[["render",Ve],["__scopeId","data-v-2f895af4"]]),$e={apiKey:"AIzaSyB3-kGIIrzMp3il9BMmB7e9YIw8MVi7eqY",authDomain:"carreiras-usp.firebaseapp.com",databaseURL:"https://carreiras-usp-default-rtdb.firebaseio.com",projectId:"carreiras-usp",storageBucket:"carreiras-usp.firebasestorage.app",messagingSenderId:"870850312201",appId:"1:870850312201:web:edc7a5a5e757c9187620d8"},R=Q($e);S(R);const v=X(R),Fe={name:"DashBoardComponent",components:{GenericCard:he,GenericGraph:be,GenericTable2:Ie},data(){return{graphKeyCongregacao:1,graphKeyDepartamentos:2,temas:[],selectedTema:"",votacoesCongregacao:[],votacoesDepartamentos:[],graphDataCongregacao:[0,0,0],graphDataDepartamentos:[0,0,0],totalUnidades:0,totalDepartamentos:0,unidades:[],tableHeadersUnidades:[{text:"Campus",value:"Campus",filterable:!0},{text:"Sigla",value:"Sigla",filterable:!0},{text:"Unanimidade",value:"Unanimidade",filterable:!0},{text:"Aprovado",value:"Aprovado",filterable:!0},{text:"Apoio",value:"Apoio",filterable:!0},{text:"Favoráveis",value:"Favoráveis",filterable:!0},{text:"Contrários",value:"Contrários",filterable:!0},{text:"Abstenções",value:"Abstenções",filterable:!0}],tableHeadersDepartamentos:[{text:"Campus",value:"Campus",filterable:!0},{text:"Sigla",value:"Sigla",filterable:!0},{text:"Nome",value:"Nome",filterable:!0},{text:"Unanimidade",value:"Unanimidade",filterable:!0},{text:"Aprovado",value:"Aprovado",filterable:!0},{text:"Apoio",value:"Apoio",filterable:!0},{text:"Favoráveis",value:"Favoráveis",filterable:!0},{text:"Contrários",value:"Contrários",filterable:!0},{text:"Abstenções",value:"Abstenções",filterable:!0}],Comentarios:"Comentários",tableRowsUnidades:[],tableRowsDepartamentos:[]}},computed:{hasData(){return s=>s&&s.length>0}},watch:{selectedTema(s){s&&this.loadDashboardData()}},methods:{async fetchTemas(){try{const s=await f(g(v,"Temas"));this.temas=s.docs.map(e=>({id:e.id,...e.data()}))}catch(s){console.error("Erro ao buscar temas:",s)}},async loadDashboardData(){try{await this.fetchVotacoes(),this.calculateGraphData(),this.populateTables(),this.populateDepartamentosTable()}catch(s){console.error("Erro ao carregar dados do dashboard:",s)}},async fetchVotacoes(){try{const s=await f($(g(v,"VotacoesCongregacao"),F("temaID","==",this.selectedTema)));this.votacoesCongregacao=s.docs.map(r=>({id:r.id,...r.data()}));const e=await f($(g(v,"VotacoesDepartamentos"),F("temaID","==",this.selectedTema)));this.votacoesDepartamentos=e.docs.map(r=>({id:r.id,...r.data()}));const a=await f(g(v,"Unidades"));this.unidades=a.docs.map(r=>({id:r.id,...r.data()}))}catch(s){console.error("Erro ao buscar votações ou unidades:",s)}},async fetchTotalUnidades(){try{const s=await f(g(v,"Unidades"));this.totalUnidades=s.size}catch(s){console.error("Erro ao buscar total de unidades:",s)}},async fetchTotalDepartamentos(){try{const s=await f(g(v,"Departamentos"));this.totalDepartamentos=s.size}catch(s){console.error("Erro ao buscar total de unidades:",s)}},calculateGraphData(){const s=this.votacoesCongregacao.filter(i=>i.Aprovado==="Sim").length,e=this.votacoesCongregacao.filter(i=>i.Apoio==="Sim"&&i.Aprovado==="Não").length,a=this.votacoesCongregacao.filter(i=>i.Apoio==="Não"&&i.Aprovado==="Não").length;this.graphDataCongregacao=[s,e,a],this.graphKeyCongregacao++;const r=this.votacoesDepartamentos.filter(i=>i.Aprovado==="Sim").length,t=this.votacoesDepartamentos.filter(i=>i.Apoio==="Sim"&&i.Aprovado==="Não").length,n=this.votacoesDepartamentos.filter(i=>i.Apoio==="Não"&&i.Aprovado==="Não").length;this.graphDataDepartamentos=[r,t,n],this.graphKeyDepartamentos++,console.log("Dados convertidos para gráfico de congregação:",this.graphDataCongregacao),console.log("Dados convertidos para gráfico de departamentos:",this.graphDataDepartamentos)},populateTables(){this.tableRowsUnidades=this.votacoesCongregacao.map(s=>{var a,r,t;const e=this.unidades.find(n=>n.id===s.unidadeID);return{Campus:e?e.Campus:"N/A",Sigla:e?e.Sigla:"N/A",Unanimidade:s.Unanimidade||"N/A",Aprovado:s.Aprovado||"N/A",Apoio:s.Apoio||"N/A",Favoráveis:((a=s.Placar)==null?void 0:a.Favoraveis)||0,Contrários:((r=s.Placar)==null?void 0:r.Contrarios)||0,Abstenções:((t=s.Placar)==null?void 0:t.Abstencoes)||0,Comentários:s.Comentarios||""}})},populateDepartamentosTable(){this.tableRowsDepartamentos=this.votacoesDepartamentos.map(s=>{var r,t,n;const e=this.departamentos.find(i=>i.id===s.dptID),a=this.unidades.find(i=>i.id===(e==null?void 0:e.UnidadeID));return console.log(this.departamentos.id),{Campus:a?a.Campus:"N/A",Nome:e?e.Nome:"N/A",Sigla:a?a.Sigla:"N/A",Unanimidade:s.Unanimidade||"N/A",Aprovado:s.Aprovado||"N/A",Apoio:s.Apoio||"N/A",Favoráveis:((r=s.Placar)==null?void 0:r.Favoraveis)||0,Contrários:((t=s.Placar)==null?void 0:t.Contrarios)||0,Abstenções:((n=s.Placar)==null?void 0:n.Abstencoes)||0,Comentários:s.Comentarios||""}})},async fetchDepartamentosData(){try{const s=await f(g(v,"Departamentos"));this.departamentos=s.docs.map(r=>({id:r.id,...r.data()}));const e=await f(g(v,"Unidades"));this.unidades=e.docs.map(r=>({id:r.id,...r.data()}));const a=await f(g(v,"VotacoesDepartamentos"));this.votacoesDepartamentos=a.docs.map(r=>({id:r.id,...r.data()})),this.populateDepartamentosTable()}catch(s){console.error("Erro ao buscar dados dos departamentos:",s)}}},async mounted(){await this.fetchTemas(),await this.fetchTotalUnidades(),await this.fetchTotalDepartamentos(),await this.fetchDepartamentosData(),await this.fetchVotacoes()}},Be={class:"container-fluid layout-view py-3"},Ee={class:"mt-4"},Re={class:"mb-3"},qe=["value"],Ge={key:0,class:"col-md-12"},Le={class:"row gx-3"},Oe={class:"col-md-6"},Me={class:"row text-center mb-3"},Pe={class:"col-3"},Ke={class:"col-3"},ze={class:"col-3"},He={class:"col-3"},je={class:"row"},We={class:"col-md-12"},Ye={class:"col-md-6"},Je={key:0},Qe={class:"row text-center mb-3"},Xe={class:"col-3"},Ze={class:"col-3"},et={class:"col-3"},tt={class:"col-3"},st={class:"row"},ot={class:"col-md-12"},at={key:1,class:"text-center text-muted"};function rt(s,e,a,r,t,n){const i=C("GenericGraph"),c=C("GenericTable2"),m=C("GenericCard");return l(),d("div",Be,[b(m,{title:"Controle de Aprovação",showNewButton:!1},{content:D(()=>[o("div",Ee,[o("div",Re,[e[2]||(e[2]=o("label",{for:"tema-dropdown",class:"form-label"},"Selecione um Tema:",-1)),x(o("select",{id:"tema-dropdown",class:"form-select","onUpdate:modelValue":e[0]||(e[0]=h=>t.selectedTema=h)},[e[1]||(e[1]=o("option",{value:"",disabled:""},"Escolha um tema",-1)),(l(!0),d(A,null,w(t.temas,(h,y)=>(l(),d("option",{key:y,value:h.id},p(h.Titulo),9,qe))),128))],512),[[z,t.selectedTema]])]),t.selectedTema?(l(),d("div",Ge,[o("div",Le,[o("div",Oe,[b(m,{title:"Unidades",showNewButton:!1},{content:D(()=>[o("div",Me,[o("div",Pe,[e[3]||(e[3]=o("h6",null,"Aprovados",-1)),o("p",null,p(t.graphDataCongregacao[0]),1)]),o("div",Ke,[e[4]||(e[4]=o("h6",null,"Apoios",-1)),o("p",null,p(t.graphDataCongregacao[1]),1)]),o("div",ze,[e[5]||(e[5]=o("h6",null,"Rejeições",-1)),o("p",null,p(t.graphDataCongregacao[2]),1)]),o("div",He,[e[6]||(e[6]=o("h6",null,"Total Unidades",-1)),o("p",null,p(t.totalUnidades),1)])]),o("div",je,[o("div",We,[t.graphDataCongregacao.length?(l(),k(i,{key:t.graphKeyCongregacao,title:"Distribuição de Apoio nas Unidades",labels:["Aprovaram Texto","Apoiam Discussão","Não Aprovam ou Apoiam"],data:t.graphDataCongregacao.slice(),colors:["#4caf50","#2196f3","#FF0000"]},null,8,["data"])):u("",!0),b(c,{headers:t.tableHeadersUnidades,rows:t.tableRowsUnidades,"description-key":"Comentários"},null,8,["headers","rows"])])])]),_:1})]),o("div",Ye,[b(m,{title:"Departamentos",showNewButton:!1},{content:D(()=>[t.tableRowsDepartamentos.length?(l(),d("div",Je,[o("div",Qe,[o("div",Xe,[e[7]||(e[7]=o("h6",null,"Aprovados",-1)),o("p",null,p(t.graphDataDepartamentos[0]),1)]),o("div",Ze,[e[8]||(e[8]=o("h6",null,"Apoios",-1)),o("p",null,p(t.graphDataDepartamentos[1]),1)]),o("div",et,[e[9]||(e[9]=o("h6",null,"Rejeições",-1)),o("p",null,p(t.graphDataDepartamentos[2]),1)]),o("div",tt,[e[10]||(e[10]=o("h6",null,"Total Departamentos",-1)),o("p",null,p(t.totalDepartamentos),1)])]),o("div",st,[o("div",ot,[t.graphDataDepartamentos.length?(l(),k(i,{key:t.graphKeyDepartamentos,title:"Distribuição de Apoio nos Departamentos",labels:["Aprovaram Texto","Apoiam Discussão","Não Aprovam ou Apoiam"],data:t.graphDataDepartamentos.slice(),colors:["#4caf50","#2196f3","#FF0000"]},null,8,["data"])):u("",!0),b(c,{headers:t.tableHeadersDepartamentos,rows:t.tableRowsDepartamentos,"description-key":"Comentários"},null,8,["headers","rows"])])])])):(l(),d("p",at,"Nenhum dado disponível para Departamentos."))]),_:1})])])])):u("",!0)])]),_:1})])}const nt=_(Fe,[["render",rt],["__scopeId","data-v-f630507f"]]),it={name:"DashBoardView",components:{DashBoardComponent:nt}};function lt(s,e,a,r,t,n){const i=C("DashBoardComponent");return l(),k(i)}const dt=_(it,[["render",lt]]),ct={data(){return{email:"",password:"",errorMessage:""}},methods:{async login(){const s=S();try{await Z(s,this.email,this.password),this.$router.push("/")}catch(e){this.errorMessage="Erro ao fazer login: "+e.message}}}},pt={class:"login-page"},ut={key:0};function mt(s,e,a,r,t,n){return l(),d("div",pt,[e[6]||(e[6]=o("h1",null,"Login",-1)),o("form",{onSubmit:e[2]||(e[2]=H((...i)=>n.login&&n.login(...i),["prevent"]))},[o("div",null,[e[3]||(e[3]=o("label",{for:"email"},"E-mail",-1)),x(o("input",{type:"email",id:"email","onUpdate:modelValue":e[0]||(e[0]=i=>t.email=i),required:""},null,512),[[N,t.email]])]),o("div",null,[e[4]||(e[4]=o("label",{for:"password"},"Senha",-1)),x(o("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=i=>t.password=i),required:""},null,512),[[N,t.password]])]),e[5]||(e[5]=o("button",{type:"submit"},"Entrar",-1))],32),t.errorMessage?(l(),d("p",ut,p(t.errorMessage),1)):u("",!0)])}const ht=_(ct,[["render",mt]]),q=j({history:W(),routes:[{path:"/login",name:"Login",component:ht},{path:"/",name:"Dash",component:dt,meta:{requiresAuth:!0}}]});q.beforeEach((s,e,a)=>{const r=S();s.matched.some(n=>n.meta.requiresAuth)?B(r,n=>{n?a():a("/login")}):a()});const G=Y(ne);G.use(q);G.mount("#app");
