import{r as P,o as F,a as i,c as d,b as s,d as _,w as A,u as x,e as g,f as k,R as K,g as z,t as p,h as N,F as f,i as v,n as q,j as U,k as y,v as w,l as I,m as E,p as R,q as j,s as H,x as Q}from"./vue-vendor-BynTeC-g.js";import{g as S,o as L,s as W,i as Y,a as J,b as u,c as m,q as V,w as B,d as X}from"./vendor-BoDgcQ-v.js";import{C as $,r as Z}from"./chartjs-v-CiLEzH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function o(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(e){if(e.ep)return;e.ep=!0;const r=o(e);fetch(e.href,r)}})();const b=(a,t)=>{const o=a.__vccOpts||a;for(const[c,e]of t)o[c]=e;return o},ee={id:"app"},te={class:"app-header"},ae={class:"app-nav"},se={class:"app-main"},oe={__name:"App",setup(a){const t=S(),o=P(!1);F(()=>{L(t,e=>{o.value=!!e})});function c(){W(t).then(()=>{alert("Você saiu com sucesso!"),window.location.href="/login"}).catch(e=>{console.error("Erro ao sair:",e.message)})}return(e,r)=>(i(),d("div",ee,[s("header",te,[s("nav",ae,[_(x(K),{to:"/",class:"nav-link"},{default:A(()=>r[0]||(r[0]=[k("Dashboard")])),_:1}),o.value?(i(),d("button",{key:0,class:"logout-button",onClick:c}," Sair ")):g("",!0)])]),s("main",se,[_(x(z))])]))}},re=b(oe,[["__scopeId","data-v-4aff2a07"]]),ne={name:"GenericCard",props:{title:{type:String,required:!0},showNewButton:{type:Boolean,default:!0}}},ie={class:"card generic-card"},de={class:"card-header d-flex justify-content-between align-items-center"},le={class:"mb-0"},ce={class:"card-body"},pe={key:0,class:"card-footer"};function ue(a,t,o,c,e,r){return i(),d("div",ie,[s("div",de,[s("h5",le,p(o.title),1),o.showNewButton?(i(),d("button",{key:0,class:"btn btn-sm btn-primary",onClick:t[0]||(t[0]=l=>a.$emit("newItem"))},t[1]||(t[1]=[s("i",{class:"fas fa-plus"},null,-1),k(" Novo ")]))):g("",!0)]),s("div",ce,[N(a.$slots,"content",{},()=>[t[2]||(t[2]=s("p",{class:"text-muted"},"Sem conteúdo disponível.",-1))])]),a.$slots.footer?(i(),d("div",pe,[N(a.$slots,"footer",{},void 0)])):g("",!0)])}const me=b(ne,[["render",ue],["__scopeId","data-v-f107b3e7"]]);$.register(...Z);const he={props:{title:{type:String,default:""},labels:{type:Array,required:!0},data:{type:Array,required:!0},colors:{type:Array,required:!0},width:{type:String,default:"100%"},height:{type:String,default:"400px"}},data(){return{selectedIndex:null}},mounted(){this.createChart()},methods:{createChart(){const a=this.$refs.chartCanvas.getContext("2d");this.chart=new $(a,{type:"doughnut",data:{labels:this.labels,datasets:[{data:this.data,backgroundColor:this.colors,hoverOffset:15}]},options:{responsive:!0,plugins:{tooltip:{enabled:!0}},onHover:(t,o)=>{if(o.length){const c=o[0],e=this.chart.data.datasets[c.datasetIndex];e.hoverOffset=20,this.chart.update()}},onLeave:()=>{this.chart.data.datasets.forEach((t,o)=>{t.hoverOffset=this.selectedIndex===o?20:15}),this.chart.update()},onClick:(t,o)=>{if(o.length){const e=o[0].index;this.selectedIndex=e,this.chart.data.datasets.forEach((l,C)=>{l.hoverOffset=C===this.selectedIndex?20:15}),this.chart.update();const r=this.labels[e];this.$emit("section-clicked",r)}}}})}},beforeUnmount(){this.chart&&this.chart.destroy()}},fe={ref:"chartCanvas"};function ve(a,t,o,c,e,r){return i(),d("div",null,[s("canvas",fe,null,512)])}const ge=b(he,[["render",ve],["__scopeId","data-v-92140e7c"]]),be={name:"CustomNavbar",props:{items:{type:Array,required:!0},activeItem:{type:String,required:!0}},methods:{selectItem(a){a.disabled||this.$emit("select",a.id)}}},_e={class:"custom-navbar"},ye={class:"nav nav-tabs"},De=["onClick"];function Ce(a,t,o,c,e,r){return i(),d("div",_e,[s("ul",ye,[(i(!0),d(f,null,v(o.items,l=>(i(),d("li",{key:l.id,class:"nav-item"},[s("button",{class:q(["nav-link",{active:o.activeItem===l.id,disabled:l.disabled}]),onClick:C=>r.selectItem(l)},[s("i",{class:q([l.icon,"me-2"])},null,2),k(" "+p(l.label),1)],10,De)]))),128))])])}const we=b(be,[["render",Ce],["__scopeId","data-v-6b95e1fa"]]),Ae={apiKey:"AIzaSyB3-kGIIrzMp3il9BMmB7e9YIw8MVi7eqY",authDomain:"carreiras-usp.firebaseapp.com",databaseURL:"https://carreiras-usp-default-rtdb.firebaseio.com",projectId:"carreiras-usp",storageBucket:"carreiras-usp.firebasestorage.app",messagingSenderId:"870850312201",appId:"1:870850312201:web:edc7a5a5e757c9187620d8"},G=Y(Ae);S(G);const h=J(G),Ue={name:"DashBoardComponent",components:{GenericCard:me,GenericGraph:ge,CustomNavbar:we},data(){return{graphKey:0,graphKeyCongregacao:1,graphKeyDepartamentos:2,activeTabUnidades:"Aprovaram Texto",navbarItems:[{id:"Aprovaram Texto",label:"Aprovaram Texto",icon:"fas fa-check-circle",disabled:!1},{id:"Apoiam Discussão",label:"Apoiam Discussão",icon:"fas fa-comments",disabled:!1}],temas:[],selectedTema:"",votacoesCongregacao:[],votacoesDepartamentos:[],graphDataCongregacao:[0,0,0],graphDataDepartamentos:[0,0,0],totalUnidades:0,totalDepartamentos:0,cidades:[],unidades:[],departamentos:[],selectedCidade:"",selectedUnidade:null,selectedDepartamento:null,aprovamTextoCongregacao:[],apoiamDiscussaoCongregacao:[],nemAprovamApoiamCongregacao:[]}},watch:{selectedTema(){this.updateAllStats(),this.graphKeyCongregacao++,this.graphKeyDepartamentos++}},methods:{async fetchTotalUnidades(){try{const a=await u(m(h,"Unidades"));this.totalUnidades=a.size}catch(a){console.error("Erro ao buscar total de unidades:",a)}},async fetchTotalDepartamentos(){try{const a=await u(m(h,"Departamentos"));this.totalDepartamentos=a.size}catch(a){console.error("Erro ao buscar total de departamentos:",a)}},async fetchTemas(){try{const a=await u(m(h,"Temas"));this.temas=a.docs.map(t=>({id:t.id,...t.data()}))}catch(a){console.error("Erro ao buscar temas:",a)}},async fetchVotacoes(){try{const a=await u(m(h,"VotacoesCongregacao"));this.votacoesCongregacao=a.docs.map(o=>({id:o.id,...o.data()}));const t=await u(m(h,"VotacoesDepartamentos"));this.votacoesDepartamentos=t.docs.map(o=>({id:o.id,...o.data()}))}catch(a){console.error("Erro ao buscar votações:",a)}},async fetchCidades(){try{const t=(await u(m(h,"Unidades"))).docs.map(o=>o.data().Campus);this.cidades=[...new Set(t)],this.selectedCidade=null,this.unidades=[],this.departamentos=[]}catch(a){console.error("Erro ao buscar cidades:",a)}},async fetchUnidades(){if(!this.selectedCidade){this.unidades=[],this.departamentos=[];return}try{const a=V(m(h,"Unidades"),B("Campus","==",this.selectedCidade)),t=await u(a);this.unidades=t.docs.map(o=>({id:o.id,...o.data()})),this.selectedUnidade=null,this.departamentos=[]}catch(a){console.error("Erro ao buscar unidades:",a)}},async fetchDepartamentos(){if(!this.selectedUnidade){this.departamentos=[],this.selectedDepartamento=null;return}try{const a=V(m(h,"Departamentos"),B("UnidadeID","==",this.selectedUnidade.id)),t=await u(a);this.departamentos=t.docs.map(o=>({id:o.id,...o.data()})),this.selectedDepartamento=null}catch(a){console.error("Erro ao buscar departamentos:",a)}},calculateStats(a){if(!this.selectedTema||!a.length)return[0,0,0];const t=a.filter(e=>e.temaID===this.selectedTema&&e.Aprovado==="Sim").length,o=a.filter(e=>e.temaID===this.selectedTema&&e.Aprovado==="Não"&&e.Apoio==="Sim").length,c=a.filter(e=>e.temaID===this.selectedTema&&e.Aprovado==="Não"&&e.Apoio==="Não").length;return[t,o,c]},updateAllStats(){this.graphDataCongregacao=this.calculateStats(this.votacoesCongregacao),this.graphDataDepartamentos=this.calculateStats(this.votacoesDepartamentos),this.aprovamTextoCongregacao=this.graphDataCongregacao[0],this.apoiamDiscussaoCongregacao=this.graphDataCongregacao[1],this.nemAprovamApoiamCongregacao=this.graphDataCongregacao[2]},formatUnitDisplay(a){return a.Placar&&a.Placar.Favoraveis!==null?`${a.unidadeID} - ${a.Placar.Favoraveis} a favor, ${a.Placar.Contrarios} contra, ${a.Placar.Abstencoes} abstenções - ${a.DataVotacao}`:a.Unanimidade==="Sim"?`${a.unidadeID} (Unanimidade) - ${a.DataVotacao}`:`${a.unidadeID} - ${a.DataVotacao}`},setActiveTabUnidades(a){this.activeTabUnidades=a}},async mounted(){await this.fetchCidades(),await this.fetchTotalUnidades(),await this.fetchTotalDepartamentos(),await this.fetchTemas(),await this.fetchVotacoes(),this.updateAllStats()}},Se={class:"container-fluid layout-view"},Te={class:"mt-4"},Ie={class:"mb-3"},ke=["value"],xe={class:"row"},Ne={class:"col-md-6"},qe={class:"row"},Ee={class:"col-md-2 mb-3"},Ve={class:"row"},Be={class:"row"},Le={class:"row"},$e={class:"col-md-4 mb-3"},Ge={class:"col-md-2 mb-3"},Me={class:"row"},Oe={class:"row"},Pe={class:"row"},Fe={class:"col-md-4 mb-3"},Ke={class:"tab-content mt-3"},ze={key:0},Re={key:1},je={key:2},He={class:"col-md-6"},Qe={class:"row"},We={class:"col-md-3 mb-3"},Ye=["value"],Je={class:"col-md-2 mb-3"},Xe=["disabled"],Ze=["value"],et={class:"col-md-2 mb-3"},tt=["disabled"],at={value:"",disabled:""},st=["value"];function ot(a,t,o,c,e,r){const l=U("GenericGraph"),C=U("CustomNavbar"),T=U("GenericCard");return i(),d("div",Se,[_(T,{title:"Controle de Aprovação",showNewButton:!1},{content:A(()=>[s("div",Te,[s("div",Ie,[t[7]||(t[7]=s("label",{for:"tema-dropdown",class:"form-label"},"Selecione um Tema:",-1)),y(s("select",{id:"tema-dropdown",class:"form-select","onUpdate:modelValue":t[0]||(t[0]=n=>e.selectedTema=n)},[t[6]||(t[6]=s("option",{value:"",disabled:""},"Escolha um tema",-1)),(i(!0),d(f,null,v(e.temas,(n,D)=>(i(),d("option",{key:D,value:n.id},p(n.Titulo),9,ke))),128))],512),[[w,e.selectedTema]])]),s("div",xe,[s("div",Ne,[_(T,{title:"Panorâma Geral",showNewButton:!1},{content:A(()=>[t[9]||(t[9]=s("div",{class:"row"},[s("div",{class:"col-md-6"},[s("h4",null,"Congregação")]),s("div",{class:"col-md-6"},[s("h4",null,"Reunião de Departamento")])],-1)),s("div",qe,[s("div",Ee,[s("div",Ve,p(e.graphDataCongregacao[0]),1),s("div",Be,p(e.graphDataCongregacao[1]),1),s("div",Le,p(e.totalUnidades),1)]),s("div",$e,[(i(),I(l,{key:e.graphKeyCongregacao,title:"Distribuição de Apoio nas Unidades",labels:["Aprovaram Texto","Apoiam Discussão","Não Aprovam ou Apoiam"],data:e.graphDataCongregacao,colors:["#4caf50","#2196f3","#FF0000"],selectedLabel:e.activeTabUnidades,onSectionClicked:r.setActiveTabUnidades},null,8,["data","selectedLabel","onSectionClicked"]))]),s("div",Ge,[s("div",Me,p(e.graphDataDepartamentos[0]),1),s("div",Oe,p(e.graphDataDepartamentos[1]),1),s("div",Pe,p(e.totalDepartamentos),1)]),s("div",Fe,[(i(),I(l,{key:e.graphKeyDepartamentos,title:"",labels:["Aprovaram Texto","Apoiam Discussão","Não Aprovam ou Apoiam"],data:e.graphDataDepartamentos,colors:["#4caf50","#2196f3","#FF0000"],selectedLabel:e.activeTabUnidades,onSectionClicked:r.setActiveTabUnidades},null,8,["data","selectedLabel","onSectionClicked"]))])]),_(C,{items:e.navbarItems,activeItem:e.activeTabUnidades,onSelect:r.setActiveTabUnidades},null,8,["items","activeItem","onSelect"]),s("div",Ke,[e.activeTabUnidades==="Aprovaram Texto"?(i(),d("div",ze,[s("ul",null,[(i(!0),d(f,null,v(e.aprovamTextoCongregacao,(n,D)=>(i(),d("li",{key:D},p(r.formatUnitDisplay(n)),1))),128))])])):g("",!0),e.activeTabUnidades==="Apoiam Discussão"?(i(),d("div",Re,[s("ul",null,[(i(!0),d(f,null,v(e.apoiamDiscussaoCongregacao,(n,D)=>(i(),d("li",{key:D},p(r.formatUnitDisplay(n)),1))),128))])])):g("",!0),e.activeTabUnidades==="Não Apoiaram"?(i(),d("div",je,t[8]||(t[8]=[s("p",null,"Não há informações disponíveis para esta categoria.",-1)]))):g("",!0)])]),_:1})]),s("div",He,[_(T,{title:"Departamentos",showNewButton:!1},{content:A(()=>[s("div",Qe,[s("div",We,[t[11]||(t[11]=s("label",{for:"cidade-dropdown",class:"form-label"},"Cidade:",-1)),y(s("select",{id:"cidade-dropdown",class:"form-select","onUpdate:modelValue":t[1]||(t[1]=n=>e.selectedCidade=n),onChange:t[2]||(t[2]=(...n)=>r.fetchUnidades&&r.fetchUnidades(...n))},[t[10]||(t[10]=s("option",{value:"",disabled:""},"Cidade",-1)),(i(!0),d(f,null,v(e.cidades,n=>(i(),d("option",{key:n,value:n},p(n),9,Ye))),128))],544),[[w,e.selectedCidade]])]),s("div",Je,[t[13]||(t[13]=s("label",{for:"unidade-dropdown",class:"form-label"},"Unidade",-1)),y(s("select",{id:"unidade-dropdown",class:"form-select","onUpdate:modelValue":t[3]||(t[3]=n=>e.selectedUnidade=n),onChange:t[4]||(t[4]=(...n)=>r.fetchDepartamentos&&r.fetchDepartamentos(...n)),disabled:!e.unidades.length},[t[12]||(t[12]=s("option",{value:"",disabled:""},"Escolha uma unidade",-1)),(i(!0),d(f,null,v(e.unidades,n=>(i(),d("option",{key:n.id,value:n},p(n.Nome),9,Ze))),128))],40,Xe),[[w,e.selectedUnidade]])]),s("div",et,[t[14]||(t[14]=s("label",{for:"departamento-dropdown",class:"form-label"},"Departamento",-1)),y(s("select",{id:"departamento-dropdown",class:"form-select","onUpdate:modelValue":t[5]||(t[5]=n=>e.selectedDepartamento=n),disabled:!e.departamentos.length},[s("option",at,p(e.departamentos.length?"Escolha um departamento":"Nenhum departamento cadastrado"),1),(i(!0),d(f,null,v(e.departamentos,n=>(i(),d("option",{key:n.id,value:n},p(n.Nome),9,st))),128))],8,tt),[[w,e.selectedDepartamento]])])])]),_:1})])])])]),_:1})])}const rt=b(Ue,[["render",ot],["__scopeId","data-v-95f85a4c"]]),nt={name:"DashBoardView",components:{DashBoardComponent:rt}};function it(a,t,o,c,e,r){const l=U("DashBoardComponent");return i(),I(l)}const dt=b(nt,[["render",it]]),lt={data(){return{email:"",password:"",errorMessage:""}},methods:{async login(){const a=S();try{await X(a,this.email,this.password),this.$router.push("/")}catch(t){this.errorMessage="Erro ao fazer login: "+t.message}}}},ct={class:"login-page"},pt={key:0};function ut(a,t,o,c,e,r){return i(),d("div",ct,[t[6]||(t[6]=s("h1",null,"Login",-1)),s("form",{onSubmit:t[2]||(t[2]=R((...l)=>r.login&&r.login(...l),["prevent"]))},[s("div",null,[t[3]||(t[3]=s("label",{for:"email"},"E-mail",-1)),y(s("input",{type:"email",id:"email","onUpdate:modelValue":t[0]||(t[0]=l=>e.email=l),required:""},null,512),[[E,e.email]])]),s("div",null,[t[4]||(t[4]=s("label",{for:"password"},"Senha",-1)),y(s("input",{type:"password",id:"password","onUpdate:modelValue":t[1]||(t[1]=l=>e.password=l),required:""},null,512),[[E,e.password]])]),t[5]||(t[5]=s("button",{type:"submit"},"Entrar",-1))],32),e.errorMessage?(i(),d("p",pt,p(e.errorMessage),1)):g("",!0)])}const mt=b(lt,[["render",ut]]),M=j({history:H(),routes:[{path:"/login",name:"Login",component:mt},{path:"/",name:"Dash",component:dt,meta:{requiresAuth:!0}}]});M.beforeEach((a,t,o)=>{const c=S();a.matched.some(r=>r.meta.requiresAuth)?L(c,r=>{r?o():o("/login")}):o()});const O=Q(re);O.use(M);O.mount("#app");
